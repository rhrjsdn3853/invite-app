<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<title>{{ event.title }}</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --bg1:#f7f8fb; --bg2:#ecf1f6;
    --paper:#ffffff; --ink:#111316; --sub:#6e6e73; --line:#e5e5ea;
    --pri:#0a84ff; --pri2:#00c896;
    --radius:28px; --shadow:0 12px 32px rgba(0,0,0,.08);
  }
  @media(prefers-color-scheme:dark){
    :root{ --bg1:#0d0f12; --bg2:#050607; --paper:#111214; --ink:#f5f5f7; --sub:#a1a1a6; --line:#2c2c2e; --shadow:0 12px 36px rgba(0,0,0,.5) }
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:-apple-system,BlinkMacSystemFont,"SF Pro Display","Noto Sans KR",system-ui,sans-serif;
    color:var(--ink); -webkit-font-smoothing:antialiased;
    background: linear-gradient(160deg,var(--bg1),var(--bg2));
    transition: background .6s ease;
  }

  .stage{
    min-height:100vh; display:flex; align-items:center; justify-content:center;
    padding: clamp(20px,4vw,56px) 16px;
  }
  .card{
    width:min(780px,96vw);
    background:var(--paper);
    border:1px solid var(--line);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    padding: clamp(20px,4vw,44px);
    overflow:hidden; position:relative;
  }

  /* ===== HERO(위 정보) ===== */
  .hero-block{
    text-align:center;
    transform-origin: top center;
    transition: transform .5s ease, opacity .5s ease;
    /* 처음엔 편지가 보이지 않게: 히어로 높이를 화면보다 크게 */
    min-height: calc(100vh - 240px);
    display:flex; flex-direction:column; justify-content:center;
  }
  .title{
    margin:0 0 .4rem; font-weight:800; letter-spacing:-.3px;
    font-size: clamp(28px,4.8vw,44px);
    background: linear-gradient(90deg,var(--pri),var(--pri2));
    -webkit-background-clip:text; -webkit-text-fill-color:transparent;
  }
  .subtitle{ margin:.2rem 0 1.1rem; color:var(--sub); font-weight:600 }

  .kv{ display:inline-grid; grid-template-columns:auto 1fr; gap:.4rem 1rem; text-align:left;
       line-height:1.9; font-size:1.05rem; margin:0 auto 1.2rem; }
  .kv .i{opacity:.7}
  .div{ height:1px; background:var(--line); margin:1.2rem 0 1rem }
  .desc{ font-size:1.06rem; line-height:1.8; opacity:.95; margin-bottom:1rem }

  .countdown{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin:.4rem 0 1.1rem; }
  .cd{ background:#fff; border:1px solid var(--line); border-radius:12px; padding:12px 14px; min-width:76px; text-align:center }
  .cd-val{ display:block; font-weight:800; font-size:1.6rem; color:#111 }
  .cd-lab{ display:block; font-size:.86rem; color:var(--sub) }
  .actions{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center }
  .btn{ text-decoration:none; font-weight:700; padding:12px 16px; border-radius:10px; transition:.2s; border:1px solid var(--line); color:var(--ink); background:#fff }
  .btn.primary{ background:linear-gradient(135deg,var(--pri),var(--pri2)); border:none; color:#fff }
  .btn:hover{ transform:translateY(-2px) }

  /* ===== Letter(아래) — 처음엔 숨김, 스크롤 후 펼침 ===== */
  .letter-block{
    margin-top: clamp(18px,2.6vw,26px);
    border-top: 1px solid var(--line);
    padding-top: clamp(14px,2.2vw,22px);
    display: none;          /* 처음엔 안 보임 */
    max-height: 0;          /* 펼침 애니메이션 */
    opacity: 0;
    transform: translateY(10px);
    transition: max-height .7s ease, opacity .45s ease, transform .45s ease;
  }
  .letter-card{
    background: #fff;
    border: 1px solid var(--line);
    border-radius: 16px;
    box-shadow: 0 10px 28px rgba(0,0,0,.04);
    padding: clamp(18px, 2.4vw, 28px);
  }
  .letter-title{
    margin: 0 0 10px;
    font-size: .9rem;
    color: var(--sub);
    font-weight: 700;
    letter-spacing: .12em;
    text-transform: uppercase;
  }
  .letter-title + .hairline{
    height: 1px;
    background: var(--line);
    margin: 10px 0 14px;
  }
  .letter-body{ font-size: 1.06rem; line-height: 1.9; color: var(--ink); }
  .letter-body p{ margin: 0 0 .9rem; }

  /* 줄별 스태거 등장 */
  .line{ opacity:0; transform: translateY(6px); transition: .36s ease; }

  /* 전환 상태 */
  body.open{ background: linear-gradient(160deg,#ffffff,#f2f4f8) }
  body.open .hero-block{ transform: scale(.96); opacity:.96 }
  body.open .letter-block{ display:block; opacity:1; transform:none; } /* max-height는 JS에서 계산 */

  @media (max-width:480px){
    .kv{ grid-template-columns: 1.2rem 1fr; gap:.2rem .6rem }
  }
</style>
</head>
<body>

  <section class="stage">
    <article class="card">
      {% block content %}{% endblock %}
    </article>
  </section>

<script>
  // 스크롤 트리거: 히어로가 화면 중앙을 지나면 편지 오픈
  const letterBlock = document.getElementById('letterBlock');
  const heroBlock = document.querySelector('.hero-block');

  const openLetter = () => {
    if (document.body.classList.contains('open')) return;
    document.body.classList.add('open');
    requestAnimationFrame(()=>{
      // 실제 콘텐츠 높이에 맞춰 자연스럽게 펼침
      letterBlock.style.maxHeight = letterBlock.scrollHeight + 'px';
      // 줄별 스태거
      document.querySelectorAll('#letterBody .line').forEach((el, i) => {
        el.style.transitionDelay = (i * 40) + 'ms';
        el.style.opacity = 1;
        el.style.transform = 'none';
      });
    });
  };

  const io = new IntersectionObserver((entries)=>{
    entries.forEach(entry=>{
      if(entry.isIntersecting){ openLetter(); io.disconnect(); }
    });
  }, { root:null, threshold:0.05, rootMargin:"-42% 0px -42% 0px" });
  io.observe(heroBlock);

  window.addEventListener('resize', ()=>{
    if(document.body.classList.contains('open')){
      letterBlock.style.maxHeight = letterBlock.scrollHeight + 'px';
    }
  });
</script>

</body>
</html>
