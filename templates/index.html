{% extends "base.html" %}
{% block content %}

<header class="hero-block">
  <h1 class="title">{{ event.title }}</h1>
  <p class="subtitle">주최 · {{ event.host }}</p>

  <div class="kv">
    <div class="i">📅</div><div>{{ event.date_text }}</div>
    <div class="i">📍</div><div>{{ event.place }}</div>
  </div>

  <div class="div"></div>

  <p class="desc">{{ event.desc }}</p>

  <div class="countdown" id="countdown">
    <div class="cd"><span class="cd-val" id="d">00</span><span class="cd-lab">일</span></div>
    <div class="cd"><span class="cd-val" id="h">00</span><span class="cd-lab">시간</span></div>
    <div class="cd"><span class="cd-val" id="m">00</span><span class="cd-lab">분</span></div>
    <div class="cd"><span class="cd-val" id="s">00</span><span class="cd-lab">초</span></div>
  </div>

  <nav class="actions">
    <a class="btn primary" href="/event.ics" download aria-label="캘린더에 추가">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <rect x="3" y="5" width="18" height="16" rx="3" stroke="white" stroke-width="1.6" />
        <path d="M8 3v4M16 3v4M3 10h18" stroke="white" stroke-width="1.6" stroke-linecap="round"/>
      </svg>
      캘린더에 추가
    </a>
    <a class="btn" href="https://www.google.com/maps/search/{{ event.place | urlencode }}" target="_blank" rel="noopener" aria-label="길찾기">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M12 2c3.3 0 6 2.7 6 6 0 4.5-6 12-6 12s-6-7.5-6-12c0-3.3 2.7-6 6-6Z" stroke="currentColor" stroke-width="1.6"/>
        <circle cx="12" cy="8" r="2" fill="currentColor"/>
      </svg>
      길찾기
    </a>
  </nav>
</header>

<!-- Letter -->
<section class="letter-block" id="letterBlock">
  <div class="letter-card">
    <div class="letter-title">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M5 5l6 6M19 5l-6 6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"/>
      </svg>
      Letter from Host
    </div>
    <div class="hairline"></div>

    <div class="letter-body" id="letterBody">
      {% set lines = (event.letter or '').split('\n') %}
      {% for line in lines if line.strip() %}
        <p class="line">{{ line }}</p>
      {% endfor %}
      <p style="margin:.8rem 0 0; color:var(--sub); font-weight:600; text-align:right">— 등마루 가족 일동 —</p>
    </div>
  </div>
</section>

<script>
/* KST countdown */
const target = new Date("2025-10-22T10:00:00+09:00").getTime();
const $ = id => document.getElementById(id);
setInterval(()=>{
  const t = target - Date.now(); if(t<=0) return;
  const dd=Math.floor(t/86400000);
  const hh=Math.floor((t%86400000)/3600000);
  const mm=Math.floor((t%3600000)/60000);
  const ss=Math.floor((t%60000)/1000);
  $("d").textContent=String(dd).padStart(2,"0");
  $("h").textContent=String(hh).padStart(2,"0");
  $("m").textContent=String(mm).padStart(2,"0");
  $("s").textContent=String(ss).padStart(2,"0");
},1000);
</script>

{% endblock %}
